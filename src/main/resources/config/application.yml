# ===================================================================
# Spring Boot configuration.
#
# This configuration will be overridden by the Spring profile you use,
# for example application-dev.yml if you use the "dev" profile.
#
# More information on profiles: https://www.jhipster.tech/profiles/
# More information on configuration properties: https://www.jhipster.tech/common-application-properties/
# ===================================================================

# ===================================================================
# Standard Spring Boot properties.
# Full reference is available at:
# http://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html
# ===================================================================

management:
  endpoints:
    web:
      base-path: /management
      exposure:
        include:
          ['configprops', 'env', 'health', 'info', 'jhimetrics', 'logfile', 'loggers', 'prometheus', 'threaddump', 'jhiopenapigroups']
  endpoint:
    health:
      show-details: always
    jhimetrics:
      enabled: true
  info:
    git:
      mode: full
  health:
    mail:
      enabled: false # When using the MailService, configure an SMTP server and set this to true
    elasticsearch:
      enabled: false
  metrics:
    export:
      # Prometheus is the default metrics backend
      prometheus:
        enabled: true
        step: 60
    enable:
      http: true
      jvm: true
      logback: true
      process: true
      system: true
    distribution:
      percentiles-histogram:
        all: true
      percentiles:
        all: 0, 0.5, 0.75, 0.95, 0.99, 1.0
    tags:
      application: ${spring.application.name}
    web:
      server:
        auto-time-requests: true

spring:
  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 50MB
  resources:
    static-locations: classpath:/META-INF/resources/, classpath:/resources/, classpath:/static/, classpath:/public/, classpath:/search/, classpath:/resources/static/
  application:
    name: subscription
  config:
    import: aws-parameterstore:/config/subscription/, aws-secretsmanager:/secrets/subscription/credentials
  profiles:
    # The commented value for `active` can be replaced with valid Spring profiles to load.
    # Otherwise, it will be filled in by maven when building the JAR file
    # Either way, it can be overridden by `--spring.profiles.active` value passed in the commandline or `-Dspring.profiles.active` set in `JAVA_OPTS`
    active: #spring.profiles.active#
  jmx:
    enabled: false
  data:
    jpa:
      repositories:
        bootstrap-mode: deferred
  jpa:
    open-in-view: false
    properties:
      hibernate.jdbc.time_zone: UTC
    hibernate:
      ddl-auto: none
      naming:
        physical-strategy: org.springframework.boot.orm.jpa.hibernate.SpringPhysicalNamingStrategy
        implicit-strategy: org.springframework.boot.orm.jpa.hibernate.SpringImplicitNamingStrategy
  messages:
    basename: i18n/messages
  main:
    allow-bean-definition-overriding: true
  mvc:
    favicon:
      enabled: false
    pathmatch:
      matching-strategy: ant_path_matcher
  security:
    oauth2:
      client:
        registration:
          facebook:
            client-id: 609171666239506
            client-secret: 91d1bf6cb425e629be2e1e2638b8a4c3
            scope: user_posts
          subscription:
            provider: subscription
            client-id: 80b36c79c341ba709db28b0a5294fda0
            client-secret: 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
            scope: read_products,write_orders,read_customers,write_customers,read_customer_payment_methods,write_own_subscription_contracts,write_products,read_own_subscription_contracts,write_script_tags,write_content,write_themes,read_shipping,write_shipping,write_discounts,read_all_orders,read_merchant_managed_fulfillment_orders,write_merchant_managed_fulfillment_orders,read_locations,read_inventory,write_inventory,unauthenticated_read_selling_plans,unauthenticated_read_product_tags,unauthenticated_read_product_listings,unauthenticated_read_metaobjects,unauthenticated_read_customer_tags,unauthenticated_read_customers,unauthenticated_read_checkouts
            authorizationGrantType: authorization_code
            redirectUri: https://subscription-admin.appstle.com/login/oauth2/code/subscription
            clientAuthenticationMethod: POST
        provider:
          subscription:
            authorizationUri: https://shop_name/admin/oauth/authorize
            tokenUri: https://shop_name/admin/oauth/access_token
            userInfoUri: https://shop_name/admin/shop.json
            userNameAttribute: myshopify_domain
            userInfoAuthenticationMethod: HEADER
  session:
    store-type: jdbc
  task:
    execution:
      thread-name-prefix: subscription-task-
      pool:
        core-size: 50
        max-size: 100
        queue-capacity: 20000
    scheduling:
      thread-name-prefix: subscription-scheduling-
      pool:
        size: 20
  thymeleaf:
    mode: HTML
  output:
    ansi:
      console-available: true
  autoconfigure:
    exclude: org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration, org.springframework.boot.autoconfigure.data.redis.RedisRepositoriesAutoConfiguration
server:
  servlet:
    session:
      cookie:
        http-only: true

springdoc:
  show-actuator: true

# Properties to be exposed on the /info management endpoint
info:
  # Comma separated list of profiles that will trigger the ribbon to show
  display-ribbon-on-profiles: 'dev'

# ===================================================================
# JHipster specific properties
#
# Full reference is available at: https://www.jhipster.tech/common-application-properties/
# ===================================================================

jhipster:
  clientApp:
    name: 'subscriptionApp'
  # By default CORS is disabled. Uncomment to enable.
  cors:
    allowed-origins: 'http://localhost:8100,http://localhost:9000,http://localhost:8087,http://localhost:9008,https://cdn.shopify.com,https://subscription-admin.appstle.com,https://*.myshopify.com'
    allowed-methods: '*'
    allowed-headers: '*'
    exposed-headers: 'Authorization,Link,X-Total-Count,X-${jhipster.clientApp.name}-alert,X-${jhipster.clientApp.name}-error,X-${jhipster.clientApp.name}-params'
    allow-credentials: true
    max-age: 1800
  mail:
    from: subscription@localhost
  api-docs:
    default-include-pattern: ${server.servlet.context-path:}/api/**
    management-include-pattern: ${server.servlet.context-path:}/management/**
    title: subscription API
    description: subscription API documentation
    version: 0.0.1
    terms-of-service-url:
    contact-name:
    contact-url:
    contact-email:
    license: unlicensed
    license-url:
    servers:
      - url: https://subscription-admin.appstle.com
  cache:
    ehcache: # Ehcache configuration
      time-to-live-seconds: 3600 # By default objects stay 1 hour in the cache
      max-entries: 100 # Number of objects in each cache entry

# ===================================================================
# Application specific properties
# Add your own application properties here, see the ApplicationProperties class
# to have type-safe configuration, like in the JHipsterProperties above
#
# More documentation is available at:
# https://www.jhipster.tech/common-application-properties/
# ===================================================================

# application:

# mailgun properties
mailgun:
  domain: app.subscription.appstle.com
  base-url: https://api.mailgun.net/v3/
  api-key: key-81bc802e0a0d6b6ca5116e53cfd46021

logging:
  pattern:
    console: '%clr(%d{${LOG_DATEFORMAT_PATTERN:-yyyy-MM-dd HH:mm:ss.SSS}}){faint} %clr(${LOG_LEVEL_PATTERN:-%5p}) %clr(${PID:- }){magenta} %clr(---){faint} %clr([%15.15t]){faint} %clr(%-40.40logger{39}){cyan} %clr(:){faint} shop=%X{shop} traceId=%X{traceId} spanId=%X{spanId} %-5p [%t] %C{2} - %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}'

# svix properties
svix:
  api-key: sk_ZA2zqbmJeiXcsR4ksC1GjkZtq82rFbuO.us

aws:
  paramstore:
    prefix: /config
    name: subscription
    enabled: true
    profile-separator: _
